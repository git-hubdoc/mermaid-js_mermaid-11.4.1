
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/stylesheets/github-markdown.css">
    <link rel="stylesheet" href="/assets/stylesheets/main.css">
    <link rel="stylesheet" href="/assets/stylesheets/code-block.css">
  </head>
  <body>
    <article class="markdown-body">
      <html>
        <head></head>
        <body>
          <blockquote>
            <p><strong>Warning</strong></p>
            <h2 id="this-is-an-autogenerated-file-do-not-edit"><a aria-hidden="true" tabindex="-1" href="#this-is-an-autogenerated-file-do-not-edit"><span class="icon icon-link"></span></a>THIS IS AN AUTOGENERATED FILE. DO NOT EDIT.</h2>
            <h2 id="please-edit-the-corresponding-file-in-packagesmermaidsrcdocscommunitynew-diagrammd"><a aria-hidden="true" tabindex="-1" href="#please-edit-the-corresponding-file-in-packagesmermaidsrcdocscommunitynew-diagrammd"><span class="icon icon-link"></span></a>Please edit the corresponding file in <a href="packages/mermaid/src/docs/community/new-diagram.html">/packages/mermaid/src/docs/community/new-diagram.md</a>.</h2>
          </blockquote>
          <h1 id="adding-a-new-diagramchart-"><a aria-hidden="true" tabindex="-1" href="#adding-a-new-diagramchart-"><span class="icon icon-link"></span></a>Adding a New Diagram/Chart ðŸ“Š</h1>
          <h3 id="examples"><a aria-hidden="true" tabindex="-1" href="#examples"><span class="icon icon-link"></span></a>Examples</h3>
          <p>Please refer to the following PRs on how to use Langium to add a new diagram grammar.</p>
          <ul>
            <li><a href="https://github.com/mermaid-js/mermaid/pull/4839">https://github.com/mermaid-js/mermaid/pull/4839</a></li>
            <li><a href="https://github.com/mermaid-js/mermaid/pull/4751">https://github.com/mermaid-js/mermaid/pull/4751</a></li>
          </ul>
          <blockquote>
            <p>
              <strong>Warning</strong>
              The below steps are a work in progress and will be updated soon.
            </p>
          </blockquote>
          <h3 id="step-1-grammar--parsing"><a aria-hidden="true" tabindex="-1" href="#step-1-grammar--parsing"><span class="icon icon-link"></span></a>Step 1: Grammar &#x26; Parsing</h3>
          <h3 id="step-2-rendering"><a aria-hidden="true" tabindex="-1" href="#step-2-rendering"><span class="icon icon-link"></span></a>Step 2: Rendering</h3>
          <p>Write a renderer that given the data found during parsing renders the diagram. To look at an example look at sequenceRenderer.js rather than the flowchart renderer as this is a more generic example.</p>
          <p>Place the renderer in the diagram folder.</p>
          <h3 id="step-3-detection-of-the-new-diagram-type"><a aria-hidden="true" tabindex="-1" href="#step-3-detection-of-the-new-diagram-type"><span class="icon icon-link"></span></a>Step 3: Detection of the new diagram type</h3>
          <p>
            The second thing to do is to add the capability to detect the new diagram to type to the detectType in <code>diagram-api/detectType.ts</code>. The detection should return a key for the new diagram type.
            <a href="#aria-roledescription">This key will be used to as the aria roledescription</a>, so it should be a word that clearly describes the diagram type.
            For example, if your new diagram uses a UML deployment diagram, a good key would be "UMLDeploymentDiagram" because assistive technologies such as a screen reader
            would voice that as "U-M-L Deployment diagram." Another good key would be "deploymentDiagram" because that would be voiced as "Deployment Diagram." A bad key would be "deployment" because that would not sufficiently describe the diagram.
          </p>
          <p>Note that the diagram type key does not have to be the same as the diagram keyword chosen for the <a href="#grammar">grammar</a>, but it is helpful if they are the same.</p>
          <h3 id="common-parts-of-a-diagram"><a aria-hidden="true" tabindex="-1" href="#common-parts-of-a-diagram"><span class="icon icon-link"></span></a>Common parts of a diagram</h3>
          <p>There are a few features that are common between the different types of diagrams. We try to standardize the diagrams that work as similar as possible for the end user. The commonalities are:</p>
          <ul>
            <li>Directives, a way of modifying the diagram configuration from within the diagram code.</li>
            <li>Accessibility, a way for an author to provide additional information like titles and descriptions to people accessing a text with diagrams using a screen reader.</li>
            <li>Themes, there is a common way to modify the styling of diagrams in Mermaid.</li>
            <li>Comments should follow mermaid standards</li>
          </ul>
          <p>Here are some pointers on how to handle these different areas.</p>
          <h2 id="accessibility"><a aria-hidden="true" tabindex="-1" href="#accessibility"><span class="icon icon-link"></span></a>Accessibility</h2>
          <p>Mermaid automatically adds the following accessibility information for the diagram SVG HTML element:</p>
          <ul>
            <li>aria-roledescription</li>
            <li>accessible title</li>
            <li>accessible description</li>
          </ul>
          <h3 id="aria-roledescription"><a aria-hidden="true" tabindex="-1" href="#aria-roledescription"><span class="icon icon-link"></span></a>aria-roledescription</h3>
          <p>The aria-roledescription is automatically set to <a href="#step-3--detection-of-the-new-diagram-type">the diagram type</a> and inserted into the SVG element.</p>
          <p>See <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-roledescription">the definition of aria-roledescription</a> in <a href="https://www.w3.org/WAI/standards-guidelines/aria/">the Accessible Rich Internet Applications W3 standard.</a></p>
          <h3 id="accessible-title-and-description"><a aria-hidden="true" tabindex="-1" href="#accessible-title-and-description"><span class="icon icon-link"></span></a>accessible title and description</h3>
          <p>The syntax for accessible titles and descriptions is described in <a href="config/accessibility.html">the Accessibility documentation section.</a></p>
          <p>The functions for setting title and description are provided by a common module. This is the import in flowDb.js:</p>
          <pre><code>import {
  setAccTitle,
  getAccTitle,
  getAccDescription,
  setAccDescription,
  clear as commonClear,
} from '../../commonDb';
</code></pre>
          <p>The accessibility title and description are inserted into the SVG element in the <code>render</code> function in mermaidAPI.</p>
          <h2 id="theming"><a aria-hidden="true" tabindex="-1" href="#theming"><span class="icon icon-link"></span></a>Theming</h2>
          <p>Mermaid supports themes and has an integrated theming engine. You can read more about how the themes can be used <a href="config/theming.html">in the docs</a>.</p>
          <p>When adding themes to a diagram it comes down to a few important locations in the code.</p>
          <p>The entry point for the styling engine is in <strong>src/styles.js</strong>. The getStyles function will be called by Mermaid when the styles are being applied to the diagram.</p>
          <p>This function will in turn call a function <em>your diagram should provide</em> returning the css for the new diagram. The diagram specific, also which is commonly also called getStyles and located in the folder for your diagram under src/diagrams and should be named styles.js. The getStyles function will be called with the theme options as an argument like in the following example:</p>
          <pre><code class="language-js"><span class="pl-k">const</span> <span class="pl-c1">getStyles</span> <span class="pl-k">=</span> (<span class="pl-smi">options</span>) <span class="pl-k">=></span>
  <span class="pl-s"><span class="pl-pds">`</span></span>
<span class="pl-s">    .line {</span>
<span class="pl-s">      stroke-width: 1;</span>
<span class="pl-s">      stroke: <span class="pl-pse"><span class="pl-s1">${</span></span><span class="pl-smi">options</span><span class="pl-s1">.</span><span class="pl-smi">lineColor</span><span class="pl-pse"><span class="pl-s1">}</span></span>;</span>
<span class="pl-s">      stroke-dasharray: 2;</span>
<span class="pl-s">    }</span>
<span class="pl-s">    // ...</span>
<span class="pl-s">    <span class="pl-pds">`</span></span>;
</code></pre>
          <p>Note that you need to provide your function to the main getStyles by adding it into the themes object in <strong>src/styles.js</strong> like in the xyzDiagram in the provided example:</p>
          <pre><code class="language-js"><span class="pl-k">const</span> <span class="pl-c1">themes</span> <span class="pl-k">=</span> {
  flowchart,
  <span class="pl-s"><span class="pl-pds">'</span>flowchart-v2<span class="pl-pds">'</span></span><span class="pl-k">:</span> flowchart,
  sequence,
  xyzDiagram,
  <span class="pl-c">//...</span>
};
</code></pre>
          <p>The actual options and values for the colors are defined in <strong>src/theme/theme-[xyz].js</strong>. If you provide the options your diagram needs in the existing theme files then the theming will work smoothly without hiccups.</p>
        </body>
      </html>
    </article>
    <script src="/assets/js/code-block.js"></script>
    <script src="/assets/js/mathjax.js"></script>
    <script src="/assets/js/mermaid.js"></script>
  </body>
</html>
