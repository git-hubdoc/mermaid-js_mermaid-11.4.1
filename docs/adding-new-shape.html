
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/stylesheets/github-markdown.css">
    <link rel="stylesheet" href="/assets/stylesheets/main.css">
    <link rel="stylesheet" href="/assets/stylesheets/code-block.css">
  </head>
  <body>
    <article class="markdown-body">
      <html>
        <head></head>
        <body>
          <blockquote>
            <p><strong>Warning</strong></p>
            <h2 id="this-is-an-autogenerated-file-do-not-edit"><a aria-hidden="true" tabindex="-1" href="#this-is-an-autogenerated-file-do-not-edit"><span class="icon icon-link"></span></a>THIS IS AN AUTOGENERATED FILE. DO NOT EDIT.</h2>
            <h2 id="please-edit-the-corresponding-file-in-packagesmermaidsrcdocsadding-new-shapemd"><a aria-hidden="true" tabindex="-1" href="#please-edit-the-corresponding-file-in-packagesmermaidsrcdocsadding-new-shapemd"><span class="icon icon-link"></span></a>Please edit the corresponding file in <a href="packages/mermaid/src/docs/adding-new-shape.html">/packages/mermaid/src/docs/adding-new-shape.md</a>.</h2>
          </blockquote>
          <h1 id="custom-svg-shapes-library"><a aria-hidden="true" tabindex="-1" href="#custom-svg-shapes-library"><span class="icon icon-link"></span></a>Custom SVG Shapes Library</h1>
          <p>This library provides a collection of custom SVG shapes, utilities, and helpers for generating diagram components. The shapes are designed to be used within an SVG container and include a variety of common and complex shapes.</p>
          <h2 id="overview"><a aria-hidden="true" tabindex="-1" href="#overview"><span class="icon icon-link"></span></a>Overview</h2>
          <h2 id="shape-helpers-and-utilities"><a aria-hidden="true" tabindex="-1" href="#shape-helpers-and-utilities"><span class="icon icon-link"></span></a>Shape Helpers and Utilities</h2>
          <p>Before starting with shape creation, it's essential to familiarize yourself with the utilities provided in the <code>utils.ts</code> file from <code>packages/mermaid/src/rendering-util/rendering-elements/shapes/util.js</code>. These utilities are designed to assist with various aspects of SVG shape manipulation and ensure consistent and accurate rendering.</p>
          <h2 id="available-utilities"><a aria-hidden="true" tabindex="-1" href="#available-utilities"><span class="icon icon-link"></span></a>Available Utilities</h2>
          <h3 id="1-labelhelper"><a aria-hidden="true" tabindex="-1" href="#1-labelhelper"><span class="icon icon-link"></span></a>1. <code>labelHelper</code></h3>
          <ul>
            <li><strong>Purpose</strong>: This function creates and inserts labels inside SVG shapes.</li>
            <li><strong>Features</strong>:
              <ul>
                <li>Handles both HTML labels and plain text.</li>
                <li>Calculates the bounding box dimensions of the label.</li>
                <li>Ensures proper positioning of labels within shapes.</li>
              </ul>
            </li>
          </ul>
          <h3 id="2-updatenodebounds"><a aria-hidden="true" tabindex="-1" href="#2-updatenodebounds"><span class="icon icon-link"></span></a>2. <code>updateNodeBounds</code></h3>
          <ul>
            <li><strong>Purpose</strong>: Updates the bounding box dimensions (width and height) of a node.</li>
            <li><strong>Usage</strong>:
              <ul>
                <li>Adjusts the size of the node to fit the content or shape.</li>
                <li>Useful for ensuring that shapes resize appropriately based on their content.</li>
              </ul>
            </li>
          </ul>
          <h3 id="3-insertpolygonshape"><a aria-hidden="true" tabindex="-1" href="#3-insertpolygonshape"><span class="icon icon-link"></span></a>3. <code>insertPolygonShape</code></h3>
          <ul>
            <li><strong>Purpose</strong>: Inserts a polygon shape into an SVG container.</li>
            <li><strong>Features</strong>:
              <ul>
                <li>Handles the creation and insertion of complex polygonal shapes.</li>
                <li>Configures the shape's appearance and positioning within the SVG container.</li>
              </ul>
            </li>
          </ul>
          <h3 id="4-getnodeclasses"><a aria-hidden="true" tabindex="-1" href="#4-getnodeclasses"><span class="icon icon-link"></span></a>4. <code>getNodeClasses</code></h3>
          <ul>
            <li><strong>Purpose</strong>: Returns the appropriate CSS classes for a node based on its configuration.</li>
            <li><strong>Usage</strong>:
              <ul>
                <li>Dynamically applies CSS classes to nodes for styling purposes.</li>
                <li>Ensures that nodes adhere to the desired design and theme.</li>
              </ul>
            </li>
          </ul>
          <h3 id="5-createpathfrompoints"><a aria-hidden="true" tabindex="-1" href="#5-createpathfrompoints"><span class="icon icon-link"></span></a>5. <code>createPathFromPoints</code></h3>
          <ul>
            <li><strong>Purpose</strong>: Generates an SVG path string from an array of points.</li>
            <li><strong>Usage</strong>:
              <ul>
                <li>Converts a list of points into a smooth path.</li>
                <li>Useful for creating custom shapes or paths within the SVG.</li>
              </ul>
            </li>
          </ul>
          <h3 id="6-generatefullsinewavepoints"><a aria-hidden="true" tabindex="-1" href="#6-generatefullsinewavepoints"><span class="icon icon-link"></span></a>6. <code>generateFullSineWavePoints</code></h3>
          <ul>
            <li><strong>Purpose</strong>: Generates points for a sine wave, useful for creating wavy-edged shapes.</li>
            <li><strong>Usage</strong>:
              <ul>
                <li>Facilitates the creation of shapes with wavy or sine-wave edges.</li>
                <li>Can be used to add decorative or dynamic edges to shapes.</li>
              </ul>
            </li>
          </ul>
          <h2 id="getting-started"><a aria-hidden="true" tabindex="-1" href="#getting-started"><span class="icon icon-link"></span></a>Getting Started</h2>
          <p>To utilize these utilities, simply import them from the <code>utils.ts</code> file into your shape creation script. These helpers will streamline the process of building and customizing SVG shapes, ensuring consistent results across your projects.</p>
          <pre><code class="language-typescript"><span class="pl-k">import</span> {
  <span class="pl-smi">labelHelper</span>,
  <span class="pl-smi">updateNodeBounds</span>,
  <span class="pl-smi">insertPolygonShape</span>,
  <span class="pl-smi">getNodeClasses</span>,
  <span class="pl-smi">createPathFromPoints</span>,
  <span class="pl-smi">generateFullSineWavePoints</span>,
} <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>./utils.ts<span class="pl-pds">'</span></span>;
</code></pre>
          <h2 id="example-usage"><a aria-hidden="true" tabindex="-1" href="#example-usage"><span class="icon icon-link"></span></a>Example Usage</h2>
          <p>Hereâ€™s a basic example of how you might use some of these utilities:</p>
          <pre><code class="language-typescript"><span class="pl-k">import</span> { <span class="pl-smi">labelHelper</span>, <span class="pl-smi">insertPolygonShape</span> } <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>./utils.ts<span class="pl-pds">'</span></span>;

<span class="pl-k">const</span> <span class="pl-c1">svgContainer</span> <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>svgContainer<span class="pl-pds">'</span></span>);

<span class="pl-c">// Insert a polygon shape</span>
<span class="pl-en">insertPolygonShape</span>(<span class="pl-smi">svgContainer</span> <span class="pl-c">/* shape-specific parameters */</span>);

<span class="pl-c">// Create and insert a label inside the shape</span>
<span class="pl-en">labelHelper</span>(<span class="pl-smi">svgContainer</span> <span class="pl-c">/* label-specific parameters */</span>);
</code></pre>
          <h2 id="adding-new-shapes"><a aria-hidden="true" tabindex="-1" href="#adding-new-shapes"><span class="icon icon-link"></span></a>Adding New Shapes</h2>
          <h3 id="1-create-the-shape-function"><a aria-hidden="true" tabindex="-1" href="#1-create-the-shape-function"><span class="icon icon-link"></span></a>1. Create the Shape Function</h3>
          <p>To add a new shape:</p>
          <ul>
            <li>
              <p><strong>Create the shape function</strong>: Create a new file of name of the shape and export a function in the <code>shapes</code> directory that generates your shape. The file and function should follow the pattern used in existing shapes and return an SVG element.</p>
            </li>
            <li>
              <p><strong>Example</strong>:</p>
              <pre><code class="language-typescript"><span class="pl-k">import</span> { <span class="pl-smi">Node</span>, <span class="pl-smi">RenderOptions</span> } <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>../../types.ts<span class="pl-pds">'</span></span>;

<span class="pl-k">export</span> <span class="pl-k">const</span> <span class="pl-en">myNewShape</span> <span class="pl-k">=</span> <span class="pl-k">async</span> (
  <span class="pl-v">parent</span><span class="pl-k">:</span> <span class="pl-en">SVGAElement</span>,
  <span class="pl-v">node</span><span class="pl-k">:</span> <span class="pl-en">Node</span>,
  <span class="pl-v">renderOptions</span><span class="pl-k">:</span> <span class="pl-en">RenderOptions</span>
) <span class="pl-k">=></span> {
  <span class="pl-c">// Create your shape here</span>
  <span class="pl-k">const</span> <span class="pl-c1">shape</span> <span class="pl-k">=</span> <span class="pl-smi">parent</span>.<span class="pl-en">insert</span>(<span class="pl-s"><span class="pl-pds">'</span>g<span class="pl-pds">'</span></span>).<span class="pl-en">attr</span>(<span class="pl-s"><span class="pl-pds">'</span>class<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>my-new-shape<span class="pl-pds">'</span></span>);
  <span class="pl-c">// Add other elements or styles as needed</span>
  <span class="pl-k">return</span> <span class="pl-smi">shape</span>;
};
</code></pre>
            </li>
          </ul>
          <h3 id="2-register-the-shape"><a aria-hidden="true" tabindex="-1" href="#2-register-the-shape"><span class="icon icon-link"></span></a>2. Register the Shape</h3>
          <ul>
            <li>
              <p><strong>Register the shape</strong>: Add your shape to the <code>shapes</code> object in the <a href="rendering-util/rendering-elements/shapes.ts">main shapes module</a>. This allows your shape to be recognized and used within the system.</p>
            </li>
            <li>
              <p><strong>Example</strong>:</p>
              <pre><code class="language-typescript"><span class="pl-k">import</span> { <span class="pl-smi">myNewShape</span> } <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>./shapes/myNewShape<span class="pl-pds">'</span></span>;

<span class="pl-k">const</span> <span class="pl-c1">shapes</span> <span class="pl-k">=</span> {
  <span class="pl-k">...</span>,
  {
    <span class="pl-en">semanticName</span>: <span class="pl-s"><span class="pl-pds">'</span>My Shape<span class="pl-pds">'</span></span>,
    <span class="pl-en">name</span>: <span class="pl-s"><span class="pl-pds">'</span>Shape Name<span class="pl-pds">'</span></span>,
    <span class="pl-en">shortName</span>: <span class="pl-s"><span class="pl-pds">'</span>&#x3C;short-name><span class="pl-pds">'</span></span>,
    <span class="pl-en">description</span>: <span class="pl-s"><span class="pl-pds">'</span>&#x3C;Description for the shape><span class="pl-pds">'</span></span>,
    <span class="pl-en">aliases</span>: [<span class="pl-s"><span class="pl-pds">'</span>&#x3C;alias-one><span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&#x3C;al-on><span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&#x3C;alias-two><span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>&#x3C;al-two><span class="pl-pds">'</span></span>],
    <span class="pl-en">handler</span>: <span class="pl-smi">myNewShape</span>,
  },
};
</code></pre>
            </li>
          </ul>
          <h1 id="shape-intersection-algorithms"><a aria-hidden="true" tabindex="-1" href="#shape-intersection-algorithms"><span class="icon icon-link"></span></a>Shape Intersection Algorithms</h1>
          <p>This contains algorithms and utilities for calculating intersection points for various shapes in SVG. Arrow intersection points are crucial for accurately determining where arrows connect with shapes. Ensuring precise intersection points enhances the clarity and accuracy of flowcharts and diagrams.</p>
          <h2 id="shape-intersection-functions"><a aria-hidden="true" tabindex="-1" href="#shape-intersection-functions"><span class="icon icon-link"></span></a>Shape Intersection Functions</h2>
          <h3 id="1-ellipse"><a aria-hidden="true" tabindex="-1" href="#1-ellipse"><span class="icon icon-link"></span></a>1. <code>Ellipse</code></h3>
          <p>Calculates the intersection points for an ellipse.</p>
          <p><strong>Usage</strong>:</p>
          <pre><code class="language-javascript"><span class="pl-k">import</span> <span class="pl-smi">intersectEllipse</span> <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>./intersect-ellipse.js<span class="pl-pds">'</span></span>;

<span class="pl-k">const</span> <span class="pl-c1">intersection</span> <span class="pl-k">=</span> <span class="pl-en">intersectEllipse</span>(node, rx, ry, point);
</code></pre>
          <ul>
            <li><strong>Parameters</strong>:
              <ul>
                <li><code>node</code>: The SVG node element.</li>
                <li><code>rx</code>: The x-radius of the ellipse.</li>
                <li><code>ry</code>: The y-radius of the ellipse.</li>
                <li><code>point</code>: The point from which the intersection is calculated.</li>
              </ul>
            </li>
          </ul>
          <h3 id="2-intersectrect"><a aria-hidden="true" tabindex="-1" href="#2-intersectrect"><span class="icon icon-link"></span></a>2. <code>intersectRect</code></h3>
          <p>Calculates the intersection points for a rectangle.</p>
          <p><strong>Usage</strong>:</p>
          <pre><code class="language-javascript"><span class="pl-k">import</span> <span class="pl-smi">intersectRect</span> <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>./intersect-rect.js<span class="pl-pds">'</span></span>;

<span class="pl-k">const</span> <span class="pl-c1">intersection</span> <span class="pl-k">=</span> <span class="pl-en">intersectRect</span>(node, point);
</code></pre>
          <ul>
            <li><strong>Parameters</strong>:
              <ul>
                <li><code>node</code>: The SVG node element.</li>
                <li><code>point</code>: The point from which the intersection is calculated.</li>
              </ul>
            </li>
          </ul>
          <h3 id="3-intersectpolygon"><a aria-hidden="true" tabindex="-1" href="#3-intersectpolygon"><span class="icon icon-link"></span></a>3. <code>intersectPolygon</code></h3>
          <p>Calculates the intersection points for a polygon.</p>
          <p><strong>Usage</strong>:</p>
          <pre><code class="language-javascript"><span class="pl-k">import</span> <span class="pl-smi">intersectPolygon</span> <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">'</span>./intersect-polygon.js<span class="pl-pds">'</span></span>;

<span class="pl-k">const</span> <span class="pl-c1">intersection</span> <span class="pl-k">=</span> <span class="pl-en">intersectPolygon</span>(node, polyPoints, point);
</code></pre>
          <ul>
            <li><strong>Parameters</strong>:
              <ul>
                <li><code>node</code>: The SVG node element.</li>
                <li><code>polyPoints</code>: Array of points defining the polygon.</li>
                <li><code>point</code>: The point from which the intersection is calculated.</li>
              </ul>
            </li>
          </ul>
          <h2 id="cypress-tests"><a aria-hidden="true" tabindex="-1" href="#cypress-tests"><span class="icon icon-link"></span></a>Cypress Tests</h2>
          <p>To ensure the robustness of the flowchart shapes, there are implementation of comprehensive Cypress test cases in <code>newShapes.spec.ts</code> file. These tests cover various aspects such as:</p>
          <ul>
            <li><strong>Shapes</strong>: Testing new shapes like <code>bowTieRect</code>, <code>waveRectangle</code>, <code>trapezoidalPentagon</code>, etc.</li>
            <li><strong>Looks</strong>: Verifying shapes under different visual styles (<code>classic</code> and <code>handDrawn</code>).</li>
            <li><strong>Directions</strong>: Ensuring correct rendering in all flow directions of arrows :
              <ul>
                <li><code>TB</code> <code>(Top -> Bottom)</code></li>
                <li><code>BT</code> <code>(Bottom -> Top)</code></li>
                <li><code>LR</code> <code>(Left -> Right)</code></li>
                <li><code>RL</code> <code>(Right -> Left)</code></li>
              </ul>
            </li>
            <li><strong>Labels</strong>: Testing shapes with different labels, including:
              <ul>
                <li>No labels</li>
                <li>Short labels</li>
                <li>Very long labels</li>
                <li>Markdown with <code>htmlLabels:true</code> and <code>htmlLabels:false</code></li>
              </ul>
            </li>
            <li><strong>Styles</strong>: Applying custom styles to shapes and verifying correct rendering.</li>
            <li><strong>Class Definitions</strong>: Using <code>classDef</code> to apply custom classes and testing their impact.</li>
          </ul>
          <h3 id="running-the-tests"><a aria-hidden="true" tabindex="-1" href="#running-the-tests"><span class="icon icon-link"></span></a>Running the Tests</h3>
          <p>To run the Cypress tests, follow these steps:</p>
          <ol>
            <li>
              <p>Ensure you have all dependencies installed by running:</p>
              <pre><code class="language-bash">pnpm install
</code></pre>
            </li>
            <li>
              <p>Start the Cypress test runner:</p>
              <pre><code class="language-bash">cypress open --env updateSnapshots=true

</code></pre>
            </li>
            <li>
              <p>Select the test suite from the Cypress interface to run all the flowchart shape tests.</p>
            </li>
          </ol>
        </body>
      </html>
    </article>
    <script src="/assets/js/code-block.js"></script>
    <script src="/assets/js/mathjax.js"></script>
    <script src="/assets/js/mermaid.js"></script>
  </body>
</html>
